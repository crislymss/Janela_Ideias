{% extends "admin/base_site.html" %}
{% load static %}

{% block extrahead %}
{{ block.super }}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<style>
    /* Força a fonte 'Inter' para o corpo e elementos principais */
    body, .main-sidebar, .main-header, .content-wrapper, .card, .card-header, h1, h4, strong, small {
        font-family: 'Inter', sans-serif !important;
    }

    /* Cores exatas dos widgets da imagem-alvo (estas serão sobrepostas pelo Jazzmin theme flatly) */
    .widget-total-startups {
        background-color: #d1e7e4 !important; /* Verde-água claro */
        color: #333 !important;
        border: none !important;
    }
    .widget-recentes {
        background-color: #fef8dd !important; /* Amarelo claro */
        color: #333 !important;
        border: none !important;
    }
    .widget-formulario {
        background-color: #d6eef7 !important; /* Azul claro */
        color: #333 !important;
        border: none !important;
    }
</style>
{% endblock %}


{% block content %}
<div class="row">
    
    <div class="col-md-4">
        <div class="card widget-total-startups mb-3" style="max-width: 20rem;">
            <div class="card-header">
                <i class="bi bi-rocket-takeoff-fill"></i> Total de Startups
            </div>
            <div class="card-body">
                <h1 class="card-title">{{ total_startups|default:"0" }}</h1>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card widget-recentes mb-3" style="max-width: 20rem;">
            <div class="card-header">
                <i class="bi bi-clock-fill"></i> Recentes
            </div>
            <div class="card-body">
                <h1 class="card-title">{{ recentes_count|default:"0" }}</h1>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card widget-formulario mb-3" style="max-width: 20rem;">
            <div class="card-header">
                <i class="bi bi-calendar-check-fill"></i> Última atualização do Formulário
            </div>
            <div class="card-body">
                <h4 class="card-title">23/12/2025</h4>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-5">
        <div class="card">
            <div class="card-header">
                Últimas Startups
            </div>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for startup in ultimas_startups %}
                        <li class="list-group-item">
                            <strong>{{ startup.nome_startup }}</strong><br>
                            <small>{{ startup.data_criacao|date:"d/m/Y H:i" }}</small>
                        </li>
                    {% empty %}
                        <li class="list-group-item">Nenhuma startup encontrada.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-7">
        <div class="card">
            <div class="card-header">
                Startups por mês
            </div>
            <div class="card-body">
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extrajs %}
{{ block.super }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    const ctx = document.getElementById('myChart');
    if (!ctx) { return; }

    const labels = {{ chart_labels|safe|default:"[]" }};
    const dataPoints = {{ chart_data|safe|default:"[]" }};

    new Chart(ctx, {
        type: 'bar', 
        data: {
            labels: labels,
            datasets: [{
                label: 'Startups',
                data: dataPoints,
                backgroundColor: 'rgba(54, 162, 235, 0.6)', 
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: { 
                    beginAtZero: true,
                    ticks: { 
                        stepSize: 1,
                        font: { family: 'Inter' }
                    }
                },
                x: {
                    ticks: {
                        font: { family: 'Inter' }
                    }
                }
            },
            plugins: {
                legend: {
                    labels: { 
                        font: { family: 'Inter' }
                    }
                }
            }
        }
    });
});
</script>
{% endblock %}